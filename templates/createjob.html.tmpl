<!DOCTYPE html>
<html lang="en">
<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Create Job</title>
	<link rel="stylesheet" href="static/css/bootstrap.min.css">
</head>


<body>
<div class="container-fluid">
	<nav class="navbar navbar-expand-lg navbar-light bg-light">
		<a class="navbar-brand" href="#">Platform</a>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item">
						<a class="nav-link" href="/cronjobs">Cronjobs</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="/job">Versions</a>
					</li>
					<li class="nav-item active">
						<a class="nav-link" href="/createjob">Job<span class="sr-only">(current)</span></a>
					</li>
				</ul>
			</div>
	</nav>

	{{ if .jobOptions.Error }}
	<div class="jumbotron">
		<span>Parsing job options failed with err:</span><br><br>
		<span>{{ .jobOptions.Error }}
	</div>
	<div class="jumbotron">
		<pre>
		<span>{{ .jobOptions.Raw }}</span>
		</pre>
	</div>
	{{ else }}
	<div class="jumbotron">
		<h3>{{ .cronJob.Name }}</h3><br>
		<span>{{ .cronJob.Config.Description }}</span>
	</div>
	{{ $container := "" }}
	<form action="/createjob?cronjob={{ .cronJob.Name }}" method="post">

		{{ range $i, $v := .jobOptions.Options }}
		{{ if not (eq $v.Container $container) }}
		<div class="container">
			<div class="row">
				<div class="col"></div>
				<div class="col-6 col-form-label text-left">
					<h4>Container: {{ $v.Container }}</h4>
					{{ $container = $v.Container }}
				</div>
				<div class="col"></div>
			</div>
		</div>
		{{ end }}
		<div class="form-group row">
			<label for="{{ $v.EnvVar }}" class="col col-form-label text-right">
			{{ $v.EnvVar }}
			</label>
			<div class="col">
			{{ if eq $v.Type "string" }}
				<input class="form-control" type="test" placeholder="{{ $v.Default }}" value="{{ $v.Default }}" name="{{ $i }}">
			{{ else if eq $v.Type "list"}}
			{{ $selected := $v.Default }}
				<select class="form-control" id="{{ $v.EnvVar }}" name="{{ $i }}">
				{{ range $v.Values }}
					<option value="{{ . }}"{{ if eq . $selected }} selected{{ end }}>{{ . }}</option>
				{{ end }}
				</select>
			{{ end }}
			</div>
			<div class = "col col-form-label">
				<span>{{ $v.Description }}</span><br>
			</div>
		</div>
		{{ end }}
		<div class="form-group row">
			<div class="col"></div>
			<div class="col">
				<button type="submit" class="btn btn-primary float-right">Run</button>
			</div>
			<div class="col"></div>
		</div>
	</form>
	{{ end }}

	<script src="/static/js/jquery-3.3.1.slim.min.js"></script>
	<script src="/static/js/popper.min.js"></script>
	<script src="/static/js/bootstrap.min.js"></script>

</div>
</body>
</html>
